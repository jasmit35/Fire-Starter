<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.14 (458265)"/><meta name="author" content="Jeff Smith"/><meta name="created" content="2019-08-01 20:20:46 +0000"/><meta name="source" content="web.clip"/><meta name="source-url" content="https://sourcery.ai/blog/python-best-practices/"/><meta name="updated" content="2019-08-01 20:20:46 +0000"/><title>How to set up a perfect Python project</title></head><body><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="box-sizing:border-box;font-weight:200;font-family:&quot;Ubuntu light&quot;, sans-serif;color:white;font-size:10px;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="outline:none;box-sizing:border-box;"><div style="box-sizing:border-box;text-align:center;flex-direction:column;background-color:rgb(56, 56, 56);"><div style="box-sizing:border-box;flex:1 1 0%;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;text-align:left;"><h1 style="box-sizing:border-box;font-weight:200;font-size:4.2rem;color:rgb(255, 198, 109);">How to set up a perfect Python project</h1><div style="box-sizing:border-box;line-height:2.4rem;font-size:1.6rem;color:rgb(192, 192, 192);"><a href="https://twitter.com/brendan_m6s" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Brendan Maginnis</a></div><div style="box-sizing:border-box;line-height:2rem;font-size:1.6rem;color:rgb(192, 192, 192);">July 31, 2019</div><hr style="box-sizing:border-box;"/><div style="box-sizing:border-box;text-rendering:optimizeLegibility;overflow-wrap:break-word;line-height:3.3rem;font-size:2rem;font-weight:200;"><p style="box-sizing:border-box;"/><div style="margin:4rem auto;box-sizing:border-box;">
    <a href="https://sourcery.ai/static/603b22db8b9c7b46b85b88f3c737fd10/b0cb9/trees.jpg" target="_blank" rel="noopener" style="display:block;box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">
    <span style="max-width:800px;margin-right:auto;margin-left:auto;display:block;position:relative;box-sizing:border-box;">
    <span style="opacity:0;display:block;background-size:cover;background-image:url('https://sourcery.ai/blog/python-best-practices/data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAIBBP/aAAwDAQACEAMQAAABuXOnFckwz//EABoQAAICAwAAAAAAAAAAAAAAAAECAAMSISL/2gAIAQEAAQUCqAMZsSbNpaTH6Zp//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bp//EABYRAQEBAAAAAAAAAAAAAAAAAAASYf/aAAgBAgEBPwHEv//EABsQAAEEAwAAAAAAAAAAAAAAAAABEBEhcYGh/9oACAEBAAY/Ar0ceBMH/8QAHBAAAgICAwAAAAAAAAAAAAAAAREAMSFBUYHB/9oACAEBAAE/IaYtwB4tN4YnJ9QEQdFQy1s3MeTC5//aAAwDAQACAAMAAAAQgO//xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAwEBPxAit//EABgRAAIDAAAAAAAAAAAAAAAAAAABMUFR/9oACAECAQE/EMiJVR//xAAdEAEAAwEAAgMAAAAAAAAAAAABABEhMVFhgZHw/9oACAEBAAE/EAk4dOn3EemAvPwnzHQA3KFVCbMDXiK2qsp0HIr3tqtep//Z&amp;quot;');left:0px;bottom:0px;position:relative;padding-bottom:66.66666666666666%;box-sizing:border-box;"/>
    <img src="How%20to%20set%20up%20a%20perfect%20Python%20project.html.resources/CD8F7E04-0AE9-4806-8C9F-CE48BA412E3F.jpg" height="533" width="800"/>
  </span>
  </a>
    <div style="box-sizing:border-box;text-align:center;font-size:1.5rem;">Photo by Martin Adams on Unsplash</div>
  </div><p style="box-sizing:border-box;"/>
<p style="box-sizing:border-box;">When starting a new Python project, it is tempting to just dive in and start coding. Spending a tiny amount of time to setup a project with the best tools will save immense time and lead to a happier coding experience.</p>
<p style="box-sizing:border-box;">In an ideal world, dependencies would be identical for all developers, code
would be perfectly formatted, common errors forbidden and everything would be
covered by tests. Additionally, all of these would ensured at each commit.</p>
<p style="box-sizing:border-box;">In this article I'll go through how to set up a project that does exactly that. You can either follow along with the steps or jump straight to generating a new project automatically by installing <a href="https://sourcery.ai/blog/python-best-practices/#pipx" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">pipx</a> and <a href="https://sourcery.ai/blog/python-best-practices/#pipenv" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">pipenv</a> then <a href="https://sourcery.ai/blog/python-best-practices/#generate" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">generating a new project</a>.</p>
<p style="box-sizing:border-box;">Let's create a new project directory:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(255, 198, 109);">mkdir</span> best_practices
<span style="box-sizing:border-box;color:rgb(255, 198, 109);">cd</span> best_practices</code></pre></div>
<h1 style="box-sizing:border-box;font-weight:200;"><a name="pipx" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;"/>Python command line tools with pipx</h1>
<p style="box-sizing:border-box;"><a href="https://pipxproject.github.io/pipx/" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Pipx</a> is a handy utility that allows quick installation of python command line tools. We'll be using it to install pipenv and cookiecutter.</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">python3 -m pip <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> --user pipx
python3 -m pipx ensurepath</code></pre></div>
<h1 style="box-sizing:border-box;font-weight:200;"><a name="pipenv" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;"/>Dependency management with pipenv</h1>
<blockquote style="box-sizing:border-box;padding-left:1.5rem;margin-left:0px;color:lightgrey;border-left-color:rgb(40, 40, 40);border-left-style:solid;border-left-width:4px;">
<p style="box-sizing:border-box;"><a href="https://github.com/pypa/pipenv" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Pipenv</a> automatically creates and manages a
virtualenv for your projects, as well as adding/removing packages from your
Pipfile as you install/uninstall packages. It also generates the ever-important
Pipfile.lock, which is used to produce deterministic builds.</p>
</blockquote>
<p style="box-sizing:border-box;">Knowing that you and your teammates are using the same library versions is a huge confidence boost. Pipenv takes care of this and has gained massive traction in the last year or so.</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipx <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> pipenv</code></pre></div>
<h1 style="box-sizing:border-box;font-weight:200;">Code formatting with black and isort</h1>
<p style="box-sizing:border-box;"><a href="https://github.com/psf/black" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Black</a> formats our code:</p>
<blockquote style="box-sizing:border-box;padding-left:1.5rem;margin-left:0px;color:lightgrey;border-left-color:rgb(40, 40, 40);border-left-style:solid;border-left-width:4px;">
<p style="box-sizing:border-box;">Black is the uncompromising Python code formatter. By using it, you agree to cede control over minutiae of hand-formatting. In return, Black gives you speed, determinism, and freedom from pycodestyle nagging about formatting. You will save time and mental energy for more important matters.</p>
<p style="box-sizing:border-box;">Blackened code looks the same regardless of the project you're reading. Formatting becomes transparent after a while and you can focus on the content instead.</p>
<p style="box-sizing:border-box;">Black makes code review faster by producing the smallest diffs possible.</p>
</blockquote>
<p style="box-sizing:border-box;">while <a href="https://github.com/timothycrosley/isort" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">isort</a> sorts our imports:</p>
<blockquote style="box-sizing:border-box;padding-left:1.5rem;margin-left:0px;color:lightgrey;border-left-color:rgb(40, 40, 40);border-left-style:solid;border-left-width:4px;">
<p style="box-sizing:border-box;">isort your python imports for you so you don't have to.
isort is a Python utility / library to sort imports alphabetically, and automatically separated into sections.</p>
</blockquote>
<p style="box-sizing:border-box;">Let's install them using pipenv as development dependencies so they don't clutter a deployment:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> black isort --dev</code></pre></div>
<p style="box-sizing:border-box;">Black and isort have incompatible default options so we'll override isort to follow black's lead. Create a <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">setup.cfg</code> file and add this config:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span><span style="box-sizing:border-box;">isort</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">multi_line_output</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span><span style="box-sizing:border-box;color:rgb(104, 151, 187);">3</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">include_trailing_comma</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>True
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">force_grid_wrap</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span><span style="box-sizing:border-box;color:rgb(104, 151, 187);">0</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">use_parentheses</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>True
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">line_length</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span><span style="box-sizing:border-box;color:rgb(104, 151, 187);">88</span></code></pre></div>
<p style="box-sizing:border-box;">We can run these tools with:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv run black
pipenv run isort</code></pre></div>
<h1 style="box-sizing:border-box;font-weight:200;">Style enforcement with flake8</h1>
<p style="box-sizing:border-box;">Flake8 ensures our code follows the standard python conventions as defined in PEP8. Install using pipenv:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> flake8 --dev</code></pre></div>
<p style="box-sizing:border-box;">Just like isort it needs a little configuration to work well with black. Add this config to <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">setup.cfg</code>:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span><span style="box-sizing:border-box;">flake8</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">ignore</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> E<span style="box-sizing:border-box;color:rgb(104, 151, 187);">203</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span> E<span style="box-sizing:border-box;color:rgb(104, 151, 187);">266</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span> E<span style="box-sizing:border-box;color:rgb(104, 151, 187);">501</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span> W<span style="box-sizing:border-box;color:rgb(104, 151, 187);">503</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">max-line-length</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> <span style="box-sizing:border-box;color:rgb(104, 151, 187);">88</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">max-complexity</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> <span style="box-sizing:border-box;color:rgb(104, 151, 187);">18</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">select</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> B<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>C<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>E<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>F<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>W<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>T<span style="box-sizing:border-box;color:rgb(104, 151, 187);">4</span></code></pre></div>
<p style="box-sizing:border-box;">Now we can run flake8 with <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">pipenv run flake8</code>.</p>
<h1 style="box-sizing:border-box;font-weight:200;">Static types with mypy</h1>
<blockquote style="box-sizing:border-box;padding-left:1.5rem;margin-left:0px;color:lightgrey;border-left-color:rgb(40, 40, 40);border-left-style:solid;border-left-width:4px;">
<p style="box-sizing:border-box;"><a href="http://mypy-lang.org/" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Mypy</a> is an optional static type checker for Python that aims to combine the benefits of dynamic (or "duck") typing and static typing. Mypy combines the expressive power and convenience of Python with a powerful type system and compile-time type checking. Mypy type checks standard Python programs; run them using any Python VM with basically no runtime overhead.</p>
</blockquote>
<p style="box-sizing:border-box;">Having types in Python takes a little getting used to but the benefits are substantial. From the website:</p>
<ul style="box-sizing:border-box;">
<li style="box-sizing:border-box;">Static typing can make programs easier to understand and maintain</li>
<li style="box-sizing:border-box;">Static typing can help you find bugs earlier and with less testing and debugging</li>
<li style="box-sizing:border-box;">Static typing can help you find difficult-to-find bugs before your code goes into production</li>
</ul>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> mypy --dev</code></pre></div>
<p style="box-sizing:border-box;">Mypy by default will recursively check all imports for type annotations which leads to errors when libraries do not include these annotations.
We need to configure mypy to run only on our code and to ignore any errors for imports without type annotations.
We are assuming that our code lives in the <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">best_practices</code> package for the following config. Add this to <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">setup.cfg</code>:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span><span style="box-sizing:border-box;">mypy</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">files</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>best_practices<span style="box-sizing:border-box;color:rgb(169, 183, 198);">,</span>test
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">ignore_missing_imports</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span><span style="box-sizing:border-box;color:rgb(204, 120, 50);">true</span></code></pre></div>
<p style="box-sizing:border-box;">Now we can run mypy with:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv run mypy</code></pre></div>
<p style="box-sizing:border-box;">Here's a useful <a href="https://mypy.readthedocs.io/en/latest/cheat_sheet_py3.html" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">cheat sheet</a> for using it.</p>
<h1 style="box-sizing:border-box;font-weight:200;">Testing with pytest and pytest-cov</h1>
<p style="box-sizing:border-box;">Writing tests with <a href="https://docs.pytest.org/en/latest/" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">pytest</a> is incredibly easy and removing any friction to writing tests means we will write more of them!</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> pytest pytest-cov --dev</code></pre></div>
<p style="box-sizing:border-box;">Here's a simple example from the pytest website:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:grey;"># content of test_sample.py</span>
<span style="box-sizing:border-box;color:rgb(204, 120, 50);">def</span> <span style="box-sizing:border-box;color:rgb(255, 198, 109);">inc</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span>x<span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">return</span> x <span style="box-sizing:border-box;color:rgb(169, 183, 198);">+</span> <span style="box-sizing:border-box;color:rgb(104, 151, 187);">1</span>


<span style="box-sizing:border-box;color:rgb(204, 120, 50);">def</span> <span style="box-sizing:border-box;color:rgb(255, 198, 109);">test_answer</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">assert</span> inc<span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span><span style="box-sizing:border-box;color:rgb(104, 151, 187);">3</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span> <span style="box-sizing:border-box;color:rgb(104, 151, 187);">5</span></code></pre></div>
<p style="box-sizing:border-box;">To execute it:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">$ pipenv run pytest
<span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> <span style="box-sizing:border-box;color:rgb(255, 198, 109);">test</span> session starts <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span>
platform linux -- Python 3.x.y, pytest-5.x.y, py-1.x.y, pluggy-0.x.y
cachedir: <span style="box-sizing:border-box;color:rgb(152, 118, 170);">$PYTHON_PREFIX</span>/.pytest_cache
rootdir: <span style="box-sizing:border-box;color:rgb(152, 118, 170);">$REGENDOC_TMPDIR</span>
collected 1 item

test_sample.py F                                                     <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>100%<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>

<span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> FAILURES <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>
_______________________________ test_answer ________________________________

    def test_answer<span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span>:
<span style="box-sizing:border-box;color:rgb(169, 183, 198);">&gt;</span>       assert inc<span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span>3<span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span> 5
E       assert 4 <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span> 5
E        +  where 4 <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> inc<span style="box-sizing:border-box;color:rgb(169, 183, 198);">(</span>3<span style="box-sizing:border-box;color:rgb(169, 183, 198);">)</span>

test_sample.py:6: AssertionError
<span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> 1 failed <span style="box-sizing:border-box;color:rgb(204, 120, 50);">in</span> 0.12 seconds <span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">==</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span></code></pre></div>
<p style="box-sizing:border-box;">All our tests should go in the <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">test</code> directory so add this config to <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">setup.cfg</code>:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>tool:pytest<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">testpaths</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>test</code></pre></div>
<p style="box-sizing:border-box;">We also want to check how much of our code is covered by tests. Create a new file <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">.coveragerc</code> to only return coverage statistics for our application code, again we are assuming our application code lives in the <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">best_practices</code> module:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span><span style="box-sizing:border-box;">run</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">source</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> best_practices

<span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span><span style="box-sizing:border-box;">report</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
<span style="box-sizing:border-box;color:rgb(152, 118, 170);">exclude_lines</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>
    <span style="box-sizing:border-box;color:grey;"># Have to re-enable the standard pragma</span>
    pragma: no cover

    <span style="box-sizing:border-box;color:grey;"># Don't complain about missing debug-only code:</span>
    def __repr__
    if self\<span style="box-sizing:border-box;color:rgb(169, 183, 198);">.</span>debug

    <span style="box-sizing:border-box;color:grey;"># Don't complain if tests don't hit defensive assertion code:</span>
    raise AssertionError
    raise NotImplementedError

    <span style="box-sizing:border-box;color:grey;"># Don't complain if non-runnable code isn't run:</span>
    if <span style="box-sizing:border-box;color:rgb(104, 151, 187);">0</span>:
    if __name__ <span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">.</span>__main__<span style="box-sizing:border-box;color:rgb(169, 183, 198);">.</span>:</code></pre></div>
<p style="box-sizing:border-box;">We can now run our tests and report coverage with</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipenv run pytest --cov --cov-fail-under<span style="box-sizing:border-box;color:rgb(169, 183, 198);">=</span>100</code></pre></div>
<p style="box-sizing:border-box;">This will fail if our test coverage of the application code is less than 100%.</p>
<h1 style="box-sizing:border-box;font-weight:200;">Git hooks with pre-commit</h1>
<p style="box-sizing:border-box;">Git hooks allow you to run scripts any time you want to commit or push. This lets us run all of our linting and tests automatically every time we commit/push. <a href="https://pre-commit.com/" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">pre‑commit</a> allows easy configuration of these hooks:</p>
<blockquote style="box-sizing:border-box;padding-left:1.5rem;margin-left:0px;color:lightgrey;border-left-color:rgb(40, 40, 40);border-left-style:solid;border-left-width:4px;">
<p style="box-sizing:border-box;">Git hook scripts are useful for identifying simple issues before submission to code review. We run our hooks on every commit to automatically point out issues in code such as missing semicolons, trailing whitespace, and debug statements. By pointing these issues out before code review, this allows a code reviewer to focus on the architecture of a change while not wasting time with trivial style nitpicks.</p>
</blockquote>
<p style="box-sizing:border-box;">Here we configure all of the above tools to run on any changed python files on committing, and also to run pytest coverage only when pushing as it can be slow. Create a new file <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">.pre-commit-config.yaml</code>:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:rgb(204, 120, 50);">repos</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span>
<span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">repo</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> local
  <span style="box-sizing:border-box;color:rgb(204, 120, 50);">hooks</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span>
  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> isort
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> isort
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>commit<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run isort
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>

  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> black
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> black
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>commit<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run black
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>

  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> flake8
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> flake8
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>commit<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run flake8
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">exclude</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> setup.py

  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> mypy
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> mypy
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>commit<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run mypy
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">pass_filenames</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">false</span>

  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pytest
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pytest
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>commit<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run pytest
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>

  <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">id</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pytest<span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span>cov
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">name</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pytest
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">stages</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>push<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">language</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> system
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">entry</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> pipenv run pytest <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span>cov <span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span>cov<span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span>fail<span style="box-sizing:border-box;color:rgb(169, 183, 198);">-</span>under=100
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">types</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">[</span>python<span style="box-sizing:border-box;color:rgb(169, 183, 198);">]</span>
    <span style="box-sizing:border-box;color:rgb(204, 120, 50);">pass_filenames</span><span style="box-sizing:border-box;color:rgb(169, 183, 198);">:</span> <span style="box-sizing:border-box;color:rgb(204, 120, 50);">false</span></code></pre></div>
<p style="box-sizing:border-box;">If you ever need to skip these hooks you can run <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">git commit --no-verify</code> or <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">git push --no-verify</code></p>
<h1 style="box-sizing:border-box;font-weight:200;"><a name="generate" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;"/>Generate a project using cookiecutter</h1>
<p style="box-sizing:border-box;">Now we've seen what an ideal project contains, we can turn this into a <a href="https://github.com/sourceryai/python-best-practices-cookiecutter" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">template</a> to generate a new project with a single command:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);">pipx run cookiecutter gh:sourceryai/python-best-practices-cookiecutter</code></pre></div>
<p style="box-sizing:border-box;">Fill in the project name and repo name and your project will be generated for you.</p>
<p style="box-sizing:border-box;">To finish setting up, follow these steps:</p>
<div style="box-sizing:border-box;"><pre style="box-sizing:border-box;background-color:rgb(43, 43, 43);overflow:auto;margin:0.5em 0px;padding:1em;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);"><span style="box-sizing:border-box;color:grey;"># Enter project directory</span>
<span style="box-sizing:border-box;color:rgb(255, 198, 109);">cd</span> <span style="box-sizing:border-box;color:rgb(169, 183, 198);">&lt;</span>repo_name<span style="box-sizing:border-box;color:rgb(169, 183, 198);">&gt;</span>

<span style="box-sizing:border-box;color:grey;"># Initialise git repo</span>
<span style="box-sizing:border-box;color:rgb(255, 198, 109);">git</span> init

<span style="box-sizing:border-box;color:grey;"># Install dependencies</span>
pipenv <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> --dev

<span style="box-sizing:border-box;color:grey;"># Setup pre-commit and pre-push hooks</span>
pipenv run pre-commit <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> -t pre-commit
pipenv run pre-commit <span style="box-sizing:border-box;color:rgb(255, 198, 109);">install</span> -t pre-push</code></pre></div>
<p style="box-sizing:border-box;">The template project contains a very simple Python file and test to try the tools out on. Once you're happy with the code you can then do your first <code style="box-sizing:border-box;-webkit-hyphens:none;tab-size:4;line-height:1.5;word-break:normal;word-spacing:normal;white-space:pre;text-align:left;direction:ltr;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, monospace;color:rgb(169, 183, 198);border-bottom-left-radius:0.3em;border-bottom-right-radius:0.3em;border-top-right-radius:0.3em;border-top-left-radius:0.3em;padding:0.1em;background-color:rgb(43, 43, 43);">git commit</code> and all the hooks will be run.</p>
<h1 style="box-sizing:border-box;font-weight:200;">Editor Integration</h1>
<p style="box-sizing:border-box;">While it is great to know that the standard of code on our project will always be maintained at the highest level when committing code, it is somewhat frustrating to find out any issues after we think the code changes have all been done. It is much better to get the issues displayed in real-time.</p>
<p style="box-sizing:border-box;">Spend some time to make sure these commands are run by your code editor when saving a file. Having instant feedback means you can quickly fixup any minor issues introduced while the code is fresh in the mind.</p>
<p style="box-sizing:border-box;">Personally I use some excellent Vim plugins to accomplish this:</p>
<ul style="box-sizing:border-box;">
<li style="box-sizing:border-box;"><a href="https://github.com/dense-analysis/ale" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">ale</a> runs flake8 in real-time, and runs black, isort and mypy on file save</li>
<li style="box-sizing:border-box;"><a href="https://github.com/janko/vim-test" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">vim-test</a> with <a href="https://github.com/janko/vim-test#projectionist-integration" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">projectionist integration</a> runs pytest on file save</li>
</ul>
<h1 style="box-sizing:border-box;font-weight:200;">Sourcery</h1>
<p style="box-sizing:border-box;">The next step is to have your editor automatically refactor your code for you as you work. This is why we built <a href="https://sourcery.ai/" style="box-sizing:border-box;text-decoration:none;text-decoration-line:none;color:orange;">Sourcery</a>, give it a go!</p></div><hr style="box-sizing:border-box;"/><div style="box-sizing:border-box;margin:2rem auto;justify-content:space-around;display:flex;"><div style="box-sizing:border-box;position:relative;visibility:visible;width:76px;height:28px;"><div style="font-size: 16px; display: inline-block;"><div lang="en" style="-webkit-user-select:none;color:rgb(51, 51, 51);font-family:&quot;Helvetica Neue&quot;, Arial, sans-serif;line-height:18px;font-size:11px;font-stretch:normal;font-weight:normal;font-variant-caps:normal;font-style:normal;">
<div style="background-position:0px 0px;padding:0px;margin:0px;line-height:26px;font-size:13px;">
<div style="text-align:left;overflow:hidden;white-space:nowrap;display:inline-block;">
  <div style="width:76px;max-width:100%;zoom:1;vertical-align:top;display:inline-block;"><a href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fsourcery.ai%2Fblog%2Fpython-best-practices%2F&amp;ref_src=twsrc%5Etfw&amp;text=How%20to%20set%20up%20a%20perfect%20Python%20project%20-%20Sourcery&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fsourcery.ai%2Fblog%2Fpython-best-practices%2F" style="text-decoration:none;outline:0px;cursor:pointer;font-weight:500;color:rgb(255, 255, 255);background-color:rgb(27, 149, 224);box-sizing:border-box;position:relative;zoom:1;vertical-align:top;display:inline-block;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top-right-radius:4px;border-top-left-radius:4px;padding:1px 10px 1px 9px;height:28px;"><i style="background-repeat:no-repeat no-repeat;background-position:0px 0px;background-image:url(&amp;quot;data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E&amp;quot;);background-color:transparent;display:inline-block;position:relative;height:18px;width:18px;top:4px;"/><span style="white-space:nowrap;zoom:1;vertical-align:top;display:inline-block;margin-left:4px;">Tweet</span></a></div>
</div>



</div></div></div></div></div></div></div></div></div></div></div></div></div></div><br/></div></body></html>